---
title: "R Notebook"
output: html_notebook
---

```{r}
arransimd %>%
  ggplot() +
  geom_sf(aes(fill = Percentile)) +
  facet_wrap('year') +
  theme_grey() +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.text.y=element_blank(),
        axis.ticks.y=element_blank())
```

pre2016list3 <- list(unique(arransimd$DataZone))
pre2016list4 <- unique(arransimd$DataZone)

arransubsect <- filter(pcs,substr(label,1,4)=="KA27")

I can then use the above, and plot over the appropriate DZ shapefile.
e.g
#Projecting the coordinate selections
#Examples
```{r}
function1(function0.5("S01004372")) +
  geom_sf(data=function6(2), shape=20)
function2(function0.5("S01004372")) +
  geom_sf(data=function6(2), shape=20)
function3(function0.5("S01004372")) +
  geom_sf(data=function6(2), shape=20)
```


#Plot the percentiles as bar charts.
Pre-2016
```{r}
arransimd2 <- dplyr::filter(arransimd, year < 2016)

arransimd2 %>%
ggplot(aes(x=year, y=Percentile)) +
  geom_bar(stat="identity") +
  facet_wrap('DataZone') +
  theme_grey() +
  labs(title = "Arran SIMD Datazones", x = "Year", y = "Percentile") +
  theme(plot.title = element_text(hjust = 0.5))
```

Post-2016
```{r}
arransimd3 <- dplyr::filter(arransimd, year >= 2016)

arransimd3 %>%
ggplot(aes(x=year, y=Percentile)) +
  geom_bar(stat="identity") +
  facet_wrap('DataZone') +
  theme_grey() +
  labs(title = "Arran SIMD Datazones", x = "Year", y = "Percentile") +
  theme(plot.title = element_text(hjust = 0.5))
```

plot10 <- simple.sf %>% 
  ggplot() + 
  geom_sf(shape=20) +
  theme_grey() 

plot11 <- arransubsect %>%
  ggplot() +
  geom_sf() +
  theme(axis.text.x=element_text(angle=45, hjust = 1)) +
  theme_grey() +
  geom_sf(data=simple.sf, shape=20)

grid.arrange(plot9, plot10, plot11, nrow = 1)

plot9 <- arransubsect %>%
  ggplot() +
  geom_sf() +
  theme(axis.text.x=element_text(angle=45, hjust = 1)) +
  theme_grey()

